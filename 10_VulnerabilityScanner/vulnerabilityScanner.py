import socket  # Importing socket


# Checking if the running service is vulnerable
def isVulnerable(banner):
    vulnerableFTP = [
        'FreeFloat Ftp Server (Version 1.00)', '3Com 3CDaemon FTP Server Version 2.0', 'Ability Server 2.34', 'Sami FTP Server 2.0.2', 'vsFTPd 3.0.3', 'SSH-2.0']
    for vuln in vulnerableFTP:
        if vuln in banner:
            return vuln
    return 0


if __name__ == "__main__":
    # Scanning the IP
    ip = "192.168.43.236"
    # Scanning the following ports
    portList = [80, 443, 21, 22, 110, 995]

    for port in portList:
        # Checking if the service on the port is running and sending banner, if not then go into exception
        try:
            socket.setdefaulttimeout(2)
            s = socket.socket()
            s.connect((ip, port))
            banner = s.recv(1024)
            #print port, ":", banner
            vuln = isVulnerable(banner)
            if vuln:
                print banner, "is vulnerable on port", port
        except:
            continue
